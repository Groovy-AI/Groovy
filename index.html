<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Groovy Virtual Pet</title>
<style>
body {
  margin:0;
  font-family:'Courier New', monospace;
  background: url('https://cdna.artstation.com/p/assets/images/images/062/116/328/large/baylee-smith-interior.jpg?1682400211') no-repeat center center fixed;
  background-size: cover;
  color: #e0d8a8;
  display:flex;
  height:100vh;
  overflow:hidden;
}
#sidebar {
  width:250px;
  background: rgba(34,34,34,0.9);
  padding:20px;
  overflow-y:auto;
}
#sidebar h2 { text-align:center; color:#fff; }
#sidebar img { width:100%; border-radius:10px; margin-bottom:10px; }
#sidebar .stats { color:#fff; margin-bottom:10px; line-height:1.5; }
#sidebar ul { list-style:none; padding:0; margin:0; }
#sidebar li { margin:5px 0; }
#sidebar button {
  width:100%; padding:10px; background:#444; color:#fff;
  border:none; border-radius:5px; cursor:pointer; text-align:left;
  margin-bottom:5px;
}
#sidebar button:hover { background:#666; }
#main {
  flex:1;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:flex-start;
  position:relative;
  padding-top:50px;
}
#mood {
  font-size:36px; 
  margin-bottom:10px; 
}
#groovy {
  width:200px;
  transition: transform 0.3s;
  cursor: grab;
  position: absolute;
  left: calc(50% - 100px);
  top: 100px;
}
.bounce { animation: bounce 0.6s ease; }
.dance { animation: dance 0.5s infinite alternate; }
.sleep { opacity:0.5; }
.tilt { transform: rotate(10deg); }

@keyframes bounce { 0% { transform: translateY(0); } 50% { transform: translateY(-15px); } 100% { transform: translateY(0); } }
@keyframes dance { 0% { transform: rotate(0deg); } 50% { transform: rotate(15deg); } 100% { transform: rotate(-15deg); } }

#output {
  background: rgba(0,0,0,0.7);
  padding:15px;
  border-radius:10px;
  width:60%;
  text-align:center;
  font-size:18px;
  position: absolute;
  bottom: 80px;
}
#level {
  text-align:center;
  margin-top:10px;
  font-weight:bold;
  color:#fff;
}
button.restart {
  margin-top:10px;
  background:#ff4444;
  color:#fff;
}
</style>
</head>
<body>

<div id="sidebar">
<h2>Groovy Commands</h2>
<img id="sidebar-groovy" src="https://cdn3d.iconscout.com/3d/premium/thumb/personaje-robot-con-inteligencia-artificial-saludando-con-una-gran-sonrisa-3d-icon-png-download-11431338.png" alt="Groovy">

<div class="stats" id="batteryStats">
Battery: 100%
</div>
<div id="level">Level: 1</div>

<ul>
  <li><button onclick="interact('feed')">Feed</button></li>
  <li><button onclick="interact('drink')">Give Water</button></li>
  <li><button onclick="interact('play')">Play</button></li>
  <li><button onclick="interact('charge')">Charge</button></li>
  <li><button onclick="interact('pet')">Pet</button></li>
  <li><button onclick="interact('joke')">Tell a Joke</button></li>
  <li><button onclick="interact('dance')">Dance</button></li>
  <li><button onclick="interact('sleep')">Sleep</button></li>
  <li><button onclick="interact('workout')">Workout</button></li>
  <li><button onclick="interact('bath')">Bath</button></li>
  <li><button onclick="interact('hug')">Hug</button></li>
  <li><button onclick="interact('birthday')">Birthday</button></li>
  <li><button onclick="interact('game')">Play Number Game</button></li>
</ul>
</div>

<div id="main">
<div id="mood">üôÇ</div>
<img id="groovy" src="https://cdn3d.iconscout.com/3d/premium/thumb/personaje-robot-con-inteligencia-artificial-saludando-con-una-gran-sonrisa-3d-icon-png-download-11431338.png" alt="Groovy">
<div id="output">Loading Groovy...</div>
</div>

<script>
const groovy = document.getElementById('groovy');
const output = document.getElementById('output');
const batteryStats = document.getElementById('batteryStats');
const levelEl = document.getElementById('level');
const moodEl = document.getElementById('mood');

let battery = localStorage.getItem('groovyBattery')? parseInt(localStorage.getItem('groovyBattery')): 100;
let level = localStorage.getItem('groovyLevel')? parseInt(localStorage.getItem('groovyLevel')): 1;
let exp = localStorage.getItem('groovyExp')? parseInt(localStorage.getItem('groovyExp')): 0;
let happiness = localStorage.getItem('groovyHappiness')? parseInt(localStorage.getItem('groovyHappiness')): 80;
let dead = false;

const jokes = [
"Why did the robot go on vacation? He needed to recharge his batteries!",
"What do you call a pirate robot? Arrr2-D2!",
"Why was the robot so bad at soccer? Because it kept kicking up sparks!",
"What do you get if you cross a robot and a tractor? A transfarmer!",
"Why did the robot cross the road? Because it was programmed to!",
"How do robots pay for things? With cache!",
"Why did the computer get cold? It left its Windows open!",
"Why did the robot go on a diet? Too many bytes!"
];

const idleMessages = [
"Hey there!","Groovy is ready to party!","Beep boop! I'm groovy!","I feel fantastic today!",
"Let's dance!","Processing your awesomeness...","Groovy loves interacting with humans!",
"Groovy's circuits are buzzing with joy!","Charging up my happiness!","I am feeling groovy!",
"Fun level: MAX!","Ready for adventure!"
];

// --- TTS setup ---
let groovyVoice = null;
function loadVoices() {
  let voices = speechSynthesis.getVoices();
  if (voices.length > 0) {
    // Hard-coded cute robot voice (change the name to any available voice on your system)
    groovyVoice = voices.find(v => v.name === "Microsoft Zira Desktop - English (United States)") || voices[0];
  }
}
speechSynthesis.onvoiceschanged = loadVoices;
loadVoices();

function groovySpeak(text){
  if(!groovyVoice) loadVoices();
  // remove emojis
  let cleanText = text.replace(/[\u{1F300}-\u{1F6FF}\u{1F900}-\u{1F9FF}\u{1F600}-\u{1F64F}\u{2700}-\u{27BF}]/gu,'');
  let u = new SpeechSynthesisUtterance(cleanText);
  u.voice = groovyVoice;
  u.pitch = 1.5;
  u.rate = 1.2;
  speechSynthesis.speak(u);
}

function showMessage(msg){
  if(dead) return;
  output.textContent = msg.replace(/[\u{1F300}-\u{1F6FF}\u{1F900}-\u{1F9FF}\u{1F600}-\u{1F64F}\u{2700}-\u{27BF}]/gu,'');
  groovySpeak(msg);
}

// ‚Ä¶ rest of your original code unchanged, just replace showMessage calls with this version for TTS

function updateGroovyStats(){
  if(dead) return;
  let mood = happiness>80?'üòÑ':happiness>50?'üôÇ':happiness>20?'üòê':'üò¢';
  moodEl.textContent = mood;
  batteryStats.textContent = `Battery: ${battery}%`;
  levelEl.textContent = `Level: ${level}`;
  localStorage.setItem('groovyBattery', battery);
  localStorage.setItem('groovyHappiness', happiness);
  localStorage.setItem('groovyLevel', level);
  localStorage.setItem('groovyExp', exp);

  if(!dead){
    if(battery <= 10 && battery > 0) showMessage("Warning: Battery critically low!");
    else if(battery <= 30) showMessage("Battery is low!");
    if(happiness <= 20) showMessage("Groovy is feeling sad! Play with him!");
  }

  if(battery <= 0){
    dead = true;
    battery = 0;
    groovy.style.opacity = 0.3;
    showDeathMessage();
  }
}

// ‚Ä¶ include your gainExp, gainHappiness, idleAnimations, restartGame, intro, interact functions exactly as before, just using the new showMessage for TTS

// Drag Groovy
let isDragging=false, offsetX=0, offsetY=0;
groovy.addEventListener('mousedown',(e)=>{ isDragging=true; offsetX=e.clientX-groovy.offsetLeft; offsetY=e.clientY-groovy.offsetTop; groovy.style.cursor='grabbing'; });
document.addEventListener('mouseup',()=>{ isDragging=false; groovy.style.cursor='grab'; });
document.addEventListener('mousemove',(e)=>{ if(isDragging){ groovy.style.left=(e.clientX-offsetX)+'px'; groovy.style.top=(e.clientY-offsetY)+'px'; } });

// Initialize
updateGroovyStats();
intro();
</script>

</body>
</html>
